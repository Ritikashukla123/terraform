version: v1.0

blocks:
  - name: Terraform Workflow
    task:
      env_vars:
        TF_IN_AUTOMATION: "true"  
      jobs:
        - name: Terraform Workflow
          commands:
            - |
              ansible-playbook -c local -i localhost, -e "ansible_python_interpreter=/usr/bin/python3" - << EOF
              ---
              - hosts: localhost
                connection: local
                tasks:
                  - name: Terraform Workflow
                    block:
                      - name: Terraform Init
                        command: terraform init
                      - name: Terraform Plan
                        command: terraform plan
                      - name: Terraform Apply
                        command: terraform apply -auto-approve
              EOF


